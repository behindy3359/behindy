# Spring Boot ì„¤ì •
spring:
  application:
    name: behindy-backend
  profiles:
    active: ${SPRING_PROFILES_ACTIVE:development}
  mvc:
    async:
      request-timeout: 720000  # 12ë¶„
  http:
    client:
      timeout:
        connect: 30000  # ì—°ê²° íƒ€ì„ì•„ì›ƒ 30ì´ˆ
        read: 720000    # ì½ê¸° íƒ€ì„ì•„ì›ƒ 12ë¶„

  # ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •
  datasource:
    url: jdbc:postgresql://${DB_URL:localhost:5432/behindy}
    username: ${DB_USER:behindy}
    password: ${DB_PASS:password}
    driver-class-name: org.postgresql.Driver

  jpa:
    hibernate:
      ddl-auto: update
    show-sql: false
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true

  # Redis ì„¤ì •
  data:
    redis:
      host: ${REDIS_HOST:localhost}
      port: ${REDIS_PORT:6379}
      password: ${REDIS_PASSWORD:}
      timeout: 2000ms
      jedis:
        pool:
          max-active: 8
          max-idle: 8
          min-idle: 0

behindy:
  internal:
    api-key: ${AI_SERVER_INTERNAL_API_KEY:behindy-internal-2025-secret-key}

crypto:
  field-secret-key: ${FIELD_KEY:default_field_key_32_characters_long}
  table-secret-key: ${TABLE_KEY:default_table_key_32_characters_long}

# JWT ì„¤ì •
jwt:
  secret: ${JWT_SECRET:default_jwt_secret_key}
  access-validity: ${JWT_ACCESS_VALIDITY:900000}
  refresh-validity: ${JWT_REFRESH_VALIDITY:604800000}

# ì¿ í‚¤ ì„¤ì •
cookie:
  secure: ${COOKIE_SECURE:false}
  same-site: ${COOKIE_SAME_SITE:strict}

# ì„œìš¸ì‹œ ì§€í•˜ì²  API ì„¤ì •
seoul:
  metro:
    api:
      key: ${SEOUL_METRO_API_KEY:test_key}
      base-url: http://swopenAPI.seoul.go.kr/api/subway
      enabled: ${METRO_API_ENABLED:true}
      timeout: 10000
      retry-count: 3
      enabled-lines: ${METRO_ENABLED_LINES:1,2,3,4}
      update-interval: ${METRO_UPDATE_INTERVAL:600000}
    cache:
      ttl: ${SEOUL_METRO_CACHE_TTL:420}
    monitoring:
      daily-limit: ${METRO_DAILY_LIMIT:950}

# AI ì„œë²„ ì„¤ì •
ai:
  server:
    url: ${AI_SERVER_URL:http://llmserver:8000}
    enabled: ${AI_SERVER_ENABLED:true}
    timeout: ${AI_SERVER_TIMEOUT:720000}  # ğŸ”¥ 12ë¶„ìœ¼ë¡œ ì¦ê°€ (720ì´ˆ)
  # AI ìŠ¤í† ë¦¬ ë°°ì¹˜ ìƒì„± ì„¤ì •
  story:
    generation:
      enabled: ${AI_STORY_GENERATION_ENABLED:true}
      daily-limit: ${AI_STORY_DAILY_LIMIT:50}
      batch-size: ${AI_STORY_BATCH_SIZE:5}
      test-interval: ${AI_STORY_TEST_INTERVAL:43200000} # 12ì‹œê°„
      min-stories-per-station: ${AI_STORY_MIN_PER_STATION:2}
      retry-count: ${AI_STORY_RETRY_COUNT:3}
      generation-delay: ${AI_STORY_GENERATION_DELAY:2000}
      # ğŸ”¥ AI ì„œë²„ ì‘ë‹µ íƒ€ì„ì•„ì›ƒ ì„¤ì • (ë§¤ìš° ê¸¸ê²Œ)
      ai-timeout: ${AI_STORY_AI_TIMEOUT:720000} # 12ë¶„
      health-check-timeout: ${AI_STORY_HEALTH_TIMEOUT:10000} # í—¬ìŠ¤ì²´í¬ëŠ” 10ì´ˆ

# ë¡œê¹… ì„¤ì •
logging:
  level:
    com.example.backend: INFO
    com.example.backend.service.AIStoryScheduler: INFO
    com.example.backend.service.AIStoryService: INFO
    org.springframework.web.client.RestTemplate: DEBUG # HTTP ìš”ì²­ ìƒì„¸ ë¡œê·¸
    org.apache.http: DEBUG  # HTTP í´ë¼ì´ì–¸íŠ¸ ë””ë²„ê·¸
    org.springframework.security: WARN
    org.hibernate.SQL: ERROR
    org.hibernate.type.descriptor.sql.BasicBinder: ERROR
  pattern:
    console: "%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"

# Actuator ì„¤ì •
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: when-authorized